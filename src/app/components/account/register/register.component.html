<mat-card class="form float">
  <mat-card-title class="headline">
    Registrieren
  </mat-card-title>

  <mat-card-content>
    <ng-container *ngIf="this.mail != null && this.token != null && !done; else initial">
      <ng-container *ngIf="this.error === null; else err">
        <ng-container *ngIf="this.verified">
        <span>
          Top! Ich konnte deinen Account verifizieren. Du kannst dich nun einloggen.
        </span>
          <mat-card-actions>
            <button [queryParams]="{ mail: mail }"
                    [routerLink]="['/account/login']"
                    mat-raised-button>
              Login
            </button>
          </mat-card-actions>
        </ng-container>
      </ng-container>
    </ng-container>
  </mat-card-content>
</mat-card>

<ng-template #initial>
  <form (ngSubmit)="create()"
        *ngIf="!done; else doneTemplate"
        [formGroup]="event"
        class="register-form">
    <mat-form-field class="username">
      <input formControlName="username"
             id="username"
             matInput
             placeholder="Benutzername"
             required>
      <mat-error>{{ getUsernameErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field class="email">
      <input formControlName="email"
             id="email"
             matInput
             placeholder="E-Mail"
             required>
      <mat-error>{{ getEmailErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field class="pass" formGroupName="passwords">
      <input [type]="hide ? 'password' : 'text'"
             formControlName="password"
             id="password"
             matInput
             placeholder="Passwort"
             required>
      <button (click)="hide = !hide" aria-label="toggle password visibility" mat-icon-button matSuffix type="button">
        <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
      </button>
      <mat-error>{{ getPasswordErrorMessage() }}</mat-error>
    </mat-form-field>
    <mat-form-field class="pass" formGroupName="passwords">
      <input [type]="hide ? 'password' : 'text'"
             formControlName="passwordVerify"
             id="passwordVerify"
             matInput
             placeholder="Passwort wiederholen"
             required>
      <button (click)="hide = !hide" aria-label="toggle password visibility" mat-icon-button matSuffix type="button">
        <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
      </button>
      <mat-error>{{ getPasswordVerifyErrorMessage() }} </mat-error>
    </mat-form-field>
    <span>
        Du hast bereits einen Account?
        <br/>
        <a [routerLink]="['/account/login']">
          Mit Account einloggen!
        </a>
      </span>

    <mat-card-actions>
      <button color="primary" id="submit" mat-raised-button>
        Registrieren
      </button>
    </mat-card-actions>
  </form>
</ng-template>

<ng-template #doneTemplate>
  <span>
    Dein Account wurde erfolgreich angelegt. Bitte Folge den Anweisungen in der dir eben zugesandten E-Mail, um
    die Registrierung abzuschlie√üen.
  </span>
</ng-template>

<ng-template #err>
  <span>{{error}}</span>
</ng-template>





<ng-container *ngIf="appointment$ | async as appointment; else loading">
  <app-enrollment-create
    #enrollmentCreateRef
    (execute)="sendEnrollmentRequest($event)"
    *ngIf="!isEdit"
    [appointment]="appointment"
    [sendingRequestEmit]="sendingRequestEmit"
    [triggerDirectSend]="triggerDirectSend">
  </app-enrollment-create>
  <app-enrollment-edit
    #enrollmentEditRef
    (execute)="sendEnrollmentRequest($event)"
    *ngIf="isEdit"
    [appointment]="appointment"
    [enrollmentId]="enrollmentId"
    [permissionToken]="permissionToken"
    [sendingRequestEmit]="sendingRequestEmit"
    [triggerDirectSend]="triggerDirectSend">
  </app-enrollment-edit>
</ng-container>

<ng-template #loading>
  <app-loading *ngIf="!loaded && !showLoginAndMailForm">
  </app-loading>
  <app-fetch-appointment
    [done]="loaded && !showLoginAndMailForm">
  </app-fetch-appointment>
</ng-template>

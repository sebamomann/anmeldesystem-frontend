<h1 class="headline">Terminübersicht</h1>

<a [routerLink]="['/create']" class="title standalone">Termin hinzufügen
  <mat-icon>library_add</mat-icon>
</a>

<ng-container *ngIf="_appointments$ | async as appointment; else loading">
  <div *ngIf="!authenticationService.userIsLoggedIn()" class="mat-card basic block">
    <span>
      Logge dich ein um mehr Termine zu sehen bei denen du dabei bist.
    </span>

    <button [queryParams]="{returnUrl: router.routerState.snapshot.url}"
            [routerLink]="'/account/login'"
            color="primary" mat-raised-button>
      Login
    </button>
  </div>

  <ng-container *ngIf="_appointments.length > 0; else empty">
    <div [ngClass]="{'active': showLegend}"
         class="dashboard-legend">
      <div (click)="showLegend = !showLegend"
           [ngClass]="{'hide': showLegend}"
           class="handle">
        <span>LEGENDE</span>
        <mat-icon>chevron_left</mat-icon>
      </div>
      <div (click)="showLegend = !showLegend"
           class="list">
        <ul>
          <li>
            <div class="bookmark-wrapper">
              <div class="bookmark-block">
                <div [ngClass]="'creator'"
                     class="bookmark">
                </div>
              </div>
            </div>
            <span>Ersteller</span>
          </li>
          <li>
            <div class="bookmark-wrapper">
              <div class="bookmark-block">
                <div [ngClass]="'admin'"
                     class="bookmark">
                </div>
              </div>
            </div>
            <span>Admin</span>
          </li>
          <li>
            <div class="bookmark-wrapper">
              <div class="bookmark-block">
                <div [ngClass]="'enrolled'"
                     class="bookmark">
                </div>
              </div>
            </div>
            <span>Angemeldet</span>
          </li>
          <li>
            <div class="bookmark-wrapper">
              <div class="bookmark-block">
                <div [ngClass]="'pinned'"
                     class="bookmark">
                </div>
              </div>
            </div>
            <span>Angepinnt</span>
          </li>
        </ul>
      </div>
    </div>
    <div [@listAnimation]
         class="appointment-list-wrapper">
      <app-appointment-data *ngFor="let appointment of _appointments"
                            [appointment]="appointment"
                            [preview]="true">

      </app-appointment-data>
    </div>
  </ng-container>

  <ng-container *ngIf="appointmentsArchive.length > 0">
    <h2 class="title">Archiv</h2>
    <div [@listAnimation]="_appointments.length" class="appointment-list-wrapper">
      <ng-container *ngFor="let appointment of appointmentsArchive">
        <mat-card (click)="redirectToAppointment(appointment)" class="appointment-data archive">
          <mat-card-content>
            <span> {{ appointment.title }}</span>
            <span>{{ appointment.date | date: 'dd.MM.y, HH:mm'}}</span>
          </mat-card-content>
        </mat-card>
      </ng-container>
    </div>
  </ng-container>
</ng-container>

<ng-template #empty>
  <div *ngIf="allowToShowEmptyHint" class="empty-list standalone">
    <img src="/assets/img/404.svg">
    <span>
      Du hast gerade mit keinen aktiven Terminen zu tun. Erstelle dir einen eigenen!
    </span>
  </div>
</ng-template>

<ng-template #loading>
  <app-dashboard-template>
  </app-dashboard-template>
</ng-template>
